{% extends "base.html" %}
{% block content %}


    <div class="container bg-light p-5">

        {%if product_object %}
        <div class="row m-0 p-0">
            <div class="col-6 text-center">
                <img src="{{product_object.image.url}}" alt="" style="height:350px; max-width: 100%; ">
            </div>
            <div class="col-6 m-0 p-0">
                <div class="container h-100 m-0 p-0">
                    <p class="fs-1">{{product_object.name}}</p>
                    <p class="fs-4">{{product_object.city}}</p>
                    <p class="fs-4 ">{{product_object.price}} zł</p>
                    <p class="fs-6 ">
                        Dostępne sztuki - {{product_object.quantity}}<br/>
                        {% if in_cart != 0 %}
                        W koszyku - {{in_cart}}
                        {% endif %}
                    </p>
                    <div class="">
                        <form action="{% url 'cart_add' product_object.id%}" method="GET" id="buyForm">
                            <div class='my-3'>
                                <input class="form-control" name='counter' type="number" value='1' id="buyQuantity">
                            </div>
                            <button class="btn btn-primary text-white w-100" type="submit">Doadaj do koszyka</button>

                        </form>
                    </div>
                    <script>
                        $('#buyForm').submit(function(){
                        var quantity = $('#buyQuantity').val();
                        $(this).attr('action', $(this).attr('action').replace( "0", quantity));
                        });
                    </script>
                </div>
            </div>
        </div>
        <div class="row fs-3 p-0 m-0">
            <div class="border border-bottom border-bottom border-3 rounded-3 my-3"></div>
            {{product_object.description}}
            <div class="border border-bottom border-3 rounded-3 my-3"></div>
            <table class="table m-0 p-0">
              <tbody id="tableBody">

              </tbody>
            </table>
        </div>
        {% else %}
        <p>Nie znaleziono produktu 404 :</p>
        {% endif %}
    </div>

    <script>
        var str = "{{product_object.spec}}";
        str = str.replace(new RegExp("&"+"#"+"x27;", "g"), "\"");

        const json = JSON.parse(str);
        for(var key in json){
            if(json[key] != ""){
                var row = "<tr><td>" + key + "</td><td>" + json[key] + "</td></tr>";
                document.getElementById('tableBody').innerHTML += row;
            }
        }

    </script>
{% endblock %}
